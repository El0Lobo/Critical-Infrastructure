{% load inline_edit i18n %}
{% if props.style_font_faces %}
  {% for css in props.style_font_faces %}
    <style>{{ css|safe }}</style>
  {% endfor %}
{% endif %}
<section class="page-block page-block--downloads" {% if props.style_inline %}style="{{ props.style_inline }}"{% endif %}>
  <div class="page-block__container">
    {% if props.title or props.subtitle %}
      <div class="page-block__header">
        {% if props.title %}
          {% with style=props.style_inline_targets.title %}
            <h2 {% if style %}style="{{ style }}"{% endif %} {% inline_attrs block 'title' %}>{{ props.title|inline_richtext }}</h2>
          {% endwith %}
        {% endif %}
        {% if props.subtitle %}
          {% with style=props.style_inline_targets.subtitle %}
            <p class="muted" {% if style %}style="{{ style }}"{% endif %} {% inline_attrs block 'subtitle' %}>{{ props.subtitle|inline_richtext }}</p>
          {% endwith %}
        {% endif %}
      </div>
    {% endif %}
    {% if items %}
      <div class="page-downloads">
        {% for item in items %}
          <article class="page-download">
            {% if show_icons %}
              <div class="page-download__preview">
                {% if item.kind == 'image' %}
                  <img src="{{ item.url }}" alt="{{ item.label }}">
                {% elif item.kind == 'audio' %}
                  <audio controls preload="metadata">
                    <source src="{{ item.url }}">
                  </audio>
                {% elif item.kind == 'video' %}
                  <video controls preload="metadata">
                    <source src="{{ item.url }}">
                  </video>
                {% else %}
                  <span class="page-download__icon">
                    {% if item.kind == 'pdf' %}PDF{% elif item.kind == 'doc' %}DOC{% elif item.kind == 'archive' %}ZIP{% else %}FILE{% endif %}
                  </span>
                {% endif %}
              </div>
            {% endif %}
            <div class="page-download__meta">
              <h3>{{ item.label }}</h3>
              {% if item.description %}<p>{{ item.description }}</p>{% endif %}
              <small class="muted">
                {{ item.kind|default:"file"|upper }}
                {% if item.size_label %} · {{ item.size_label }}{% endif %}
                {% if item.duration_label %} · {{ item.duration_label }}{% endif %}
              </small>
            </div>
            <div class="page-download__actions">
              <a class="btn btn-sm btn-primary" href="{{ item.url }}" download>{{ item.button_label }}</a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">{% trans "No downloads available yet." %}</p>
    {% endif %}
  </div>
</section>
